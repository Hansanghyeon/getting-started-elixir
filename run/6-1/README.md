# 모듈과 기명 함수

이 장에서 살펴볼 내용은 다음과 같다.

- 코드의 기본 단위인 모듈
- 퍼블릭, 프라이빗 기명 함수의 정의
- 가드 조건절
- 모듈 지시자와 모듈 속성
- 얼랭 모듈의 함수 호출하기

프로그램이 어느 정도 커지면 코드를 일정한 구조로 정리하고 싶어질 것이다. 엘릭서에서는 쉽게 여러 **기명 함수**로 코드를 나누고, 이 함수들을 **모듈**로 묶어 정리할 수 있다. 사실 엘릭서의 기명 함수는 항상 모듈 내에서만 정의할 수 있다. 작은 예부터 시작해보자. 작업 디렉터리에 `times.exs`라는 소스 파일을 하나 만들자.

```exs
defmodule Times do
  def double(n) do
    n * 2
  end
end
```

Times라는 모듈을 정의하고 그 안에 double이라는 함수를 하나 두었다. 엘릭서에서는 함수를 식별하는 요소중 하나로 인자의 갯수를 사용하는데. 이 함수는 인자를 하나 받으므로 함수를 가리킬 때는 double/1로 쓸 수 있다.

## 모듈 컴파일하기

에제 파일을 컴파일해서 IEx에 로드하는 방법에는 두 가지가 있다. 첫 번째 방법은 명령줄에서 다음과 같이 입력하는 것이다.

```sh
iex times.exs
iex> Times.double(4)
8
```

IEx를 실행할 때 소스 코드가 있는 파일의 이름을 지정하면 IEx는 입력 프롬프트를 띄우기 전에 해당 파일을 컴파일해서 로드해둔다. 이미 IEx가 실행 중인 경우에는 c 헬퍼 함수를 이용해 명령줄로 나가지 않더라도 파일을 컴파일할 수 있다.

```sh
iex> c "itmes.exs"
[Times]
iex> Times.double(4)
8
iex> Times.double(123)
246
```

c "times.exs" 함수를 호출하면 소스 파일을 컴파일해 IEx로 로드한다. 그 뒤에는 Times.double을 입력해 Times 모듈에 있는 double 함수를 몇 번이든 호출할 수 있다. 함수를 실행할 때 숫자 대신 문자를 넣어 일부러 오류가 발생하도록 해보자. 어떤 일이 일어날까?

```sh
iex> Times.double("cat")
** (ArithmeticError) bad argument in arithmetic expression: "cat" * 2
    :erlang.*("cat", 2)
    times.exs:3: Times.double/1
    iex:1: (file)
```

ArithmeticError 예외가 발생하고 스택 트레이스가 출력된다. 오류 메시지의 첫째 줄은 무엇이 잘못되었는지(문자열에 대해 산술 연산을 하려 했다)를 나타낸다. 이어서 어디에서 문제가 발생했는지를 알 수 있다. 여기에서 함수 이름을 `Times.double/1`이라고 적은 데 주목하자.

엘릭서에서 기명 함수는 함수의 이름과 파라미터의 갯수로 식별된다. 우리가 만든 double 함수는 1개의 파라미터를 받으므로, 엘릭서는 이를 double/1로 식별한다. 만약 3개의 파라미터를 받는 다른 double 함수가 또 있다면, 이 함수는 double/3으로 식별된다. 적어도 엘릭서에서 두 함수는 완전히 별개다. 반면 우리는 파라미터 갯수가 다르더라도 이름이 같으면 관련 있는 함수로 생각하기 쉬우므로, 서로 관련이 없는 두 함수에는 같은 이름을 붙이지 않는 편이 좋다.